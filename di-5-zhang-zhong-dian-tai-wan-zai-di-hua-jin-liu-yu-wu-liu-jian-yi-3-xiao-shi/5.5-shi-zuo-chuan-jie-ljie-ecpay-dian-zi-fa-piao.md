---
description: 在台灣，只要您有「營業登記」，就必須開立「統一發票」。
---

# 5.5 (實作) 串接「綠界 ECPay」電子發票

我們使用 `5.2` 安裝的**同一套**「**綠界科技 WooCommerce 金物流**」外掛，來串接「**電子發票**」功能。

**前提：** 您必須已向「綠界科技」申請開通「**電子發票**」服務，並**已向國稅局申請**電子發票的「**字軌**」。

#### 步驟 1：前往 ECPay「發票」設定

1. 在 WordPress 後台，前往「WooCommerce」>「設定」。
2. 切換到「**整合 (Integration)**」頁籤。
3. 在頂端，您會看到「**ECPay (綠界科技)**」，點選它。
4. \[示意圖：WooCommerce 的「整合」頁籤，並指向 ECPay]
5. 在 ECPay 的設定頁面中，切換到「**電子發票 (E-Invoice)**」頁籤。

#### 步驟 2：啟用並填入金鑰

1. **啟用/停用：** **勾選「啟用電子發票」**。
2. **MerchantID / HashKey / HashIV：**
   * **注意：** 綠界的「發票」金鑰，**可能**與「金流」金鑰**不同**。
   * 請登入「綠界廠商後台」，在「**電子發票系統**」>「**廠商基本資料**」中，找到並複製您「**發票專用**」的 `MerchantID`, `HashKey`, `HashIV`，然後貼上。
3. **儲存設定**。

#### 步驟 3：設定「發票觸發時機」(關鍵)

在「電子發票」頁籤中，找到「**發票開立觸發時機**」(Issue invoice trigger)。

**學員痛點：** 「顧客剛下單（ATM 轉帳）還沒付款，系統就開發票了！」 「顧客刷卡了，但我還沒出貨，結果他退貨了，我還要手動去作廢發票，好麻煩！」

**解決方案：**

* 在下拉選單中，**不要**選擇「訂單成立時 (Order Created)」或「付款完成時 (Order Processing)」。
* **最佳實務（2025年）：** 請選擇「**訂單狀態轉為 \[已完成] 時 (Order status changed to Completed)**」。
* \[示意圖：選擇「訂單狀態轉為 \[已完成] 時」]

**為什麼？**

* **「已完成 (Completed)」** 這個狀態，代表「**顧客已付款，並且已收到貨**」（在 `5.4` 中，RY Tools 會在顧客取貨後自動將訂單設為「已完成」）。
* 在**確認顧客不會退貨**（或已過了 7 天鑑賞期）的**最後一刻**才開立發票，是**最保險**、最能減少您（店家）後續作廢/折讓麻煩的流程。
* 這也符合台灣的「7 天鑑賞期」規範。

#### 步驟 4：設定「發票類型」

* **發票類型 (Invoice Type)：**
  * **B2C (個人)：** 勾選「捐贈」、「手機條碼」、「會員載具」。
  * **B2B (公司)：** 勾選「公司戶」（三聯式），並確保「顯示公司抬頭」和「顯示統一編號」欄位已勾選。
* **儲存設定**。

**結帳頁面變化：** 設定完成後，顧客在「結帳頁面」的最下方，就會看到「**電子發票**」的區塊，可以自由選擇要「捐贈」、「存入手機條碼」或「開立公司統編」。
